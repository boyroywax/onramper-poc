"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodeToken = exports.encodeToken = exports.safeEncode = exports.replaceAll = void 0;
function replaceAll(src, oldStr, newStr) {
    return src.split(oldStr).join(newStr);
}
exports.replaceAll = replaceAll;
// Use 'URL and Filename Safe Alphabet' encoding to avoid '/' characters
// See https://tools.ietf.org/html/rfc4648#section-5
function safeEncode(buf) {
    return replaceAll(replaceAll(btoa(buf), "/", "_"), "+", "-");
}
exports.safeEncode = safeEncode;
function encodeToken(data) {
    return safeEncode(JSON.stringify(data));
}
exports.encodeToken = encodeToken;
function decodeToken(token) {
    const base64Token = replaceAll(replaceAll(token, "_", "/"), "-", "+");
    return JSON.parse(atob(base64Token));
}
exports.decodeToken = decodeToken;
